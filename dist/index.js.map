{"version":3,"file":"index.js","sources":["../src/checkFormat.js","../src/style.js","../src/prettiest.js"],"sourcesContent":["import fs from \"fs\"\n\nconst { resolveConfig, getFileInfo, check } = require(\"prettier\")\n\nexport const checkFormat = async ({ localRoot, ressources, afterFormat = () => {} }) => {\n  const report = {}\n\n  await Promise.all(\n    ressources.map(async (ressource) => {\n      const file = `${localRoot}/${ressource}`\n      const [source, options, info] = await Promise.all([\n        getFileContentAsString(file),\n        resolveConfig(file),\n        getFileInfo(file),\n      ])\n\n      const { ignored } = info\n      const pretty = ignored ? undefined : check(source, { ...options, filepath: file })\n      afterFormat({ ressource, pretty, ignored })\n      report[ressource] = { pretty, ignored }\n    }),\n  )\n\n  return report\n}\n\nconst getFileContentAsString = (location) =>\n  new Promise((resolve, reject) => {\n    fs.readFile(location, (error, buffer) => {\n      if (error) {\n        reject(error)\n      } else {\n        resolve(buffer.toString())\n      }\n    })\n  })\n","const close = \"\\x1b[0m\"\nconst green = \"\\x1b[32m\"\nconst red = \"\\x1b[31m\"\nconst blue = \"\\x1b[34m\"\n\nexport const prettyStyle = (string) => `${green}${string}${close}`\nexport const prettyStyleWithIcon = (string) => prettyStyle(`${prettyIcon} ${string}`)\nconst prettyIcon = \"\\u2714\" // checkmark ✔\n\nexport const uglyStyle = (string) => `${red}${string}${close}`\nexport const uglyStyleWithIcon = (string) => uglyStyle(`${uglyIcon} ${string}`)\nconst uglyIcon = \"\\u2613\" // cross ☓\n\nexport const ignoredStyle = (string) => `${blue}${string}${close}`\nexport const ignoredStyleWithIcon = (string) => ignoredStyle(`${ignoredIcon} ${string}`)\nconst ignoredIcon = \"\\u003F\" // question mark ?\n","import { checkFormat } from \"./checkFormat.js\"\nimport {\n  prettyStyle,\n  uglyStyle,\n  ignoredStyle,\n  prettyStyleWithIcon,\n  uglyStyleWithIcon,\n  ignoredStyleWithIcon,\n} from \"./style.js\"\n\nexport const prettiest = async ({ localRoot, ressources }) => {\n  const report = await checkFormat({\n    localRoot,\n    ressources,\n    afterFormat: ({ ressource, pretty, ignored }) => {\n      if (ignored) {\n        console.log(`${ressource} -> ${ignoredStyleWithIcon(\"ignored\")}`)\n        return\n      }\n      if (pretty) {\n        console.log(`${ressource} -> ${prettyStyleWithIcon(\"pretty\")}`)\n        return\n      }\n      console.log(`${ressource} -> ${uglyStyleWithIcon(\"ugly\")}`)\n    },\n  })\n\n  const prettyArray = ressources.filter((ressource) => {\n    return !report[ressource].ignored && report[ressource].pretty\n  })\n  const uglyArray = ressources.filter((ressource) => {\n    return !report[ressource].ignored && !report[ressource].pretty\n  })\n  const ignoredArray = ressources.filter((ressource) => {\n    return report[ressource].ignored\n  })\n\n  console.log(\n    `${ressources.length} files:\n- ${prettyStyle(`${prettyArray.length} pretty`)}\n- ${uglyStyle(`${uglyArray.length} ugly`)}\n- ${ignoredStyle(`${ignoredArray.length} ignored`)}`,\n  )\n\n  if (uglyArray.length) {\n    process.exit(1)\n  } else {\n    process.exit(0)\n  }\n}\n"],"names":["resolveConfig","getFileInfo","check","require","checkFormat","localRoot","ressources","afterFormat","report","Promise","all","map","ressource","file","source","options","info","getFileContentAsString","ignored","pretty","undefined","filepath","location","resolve","reject","fs","readFile","error","buffer","toString","close","green","red","blue","prettyStyle","string","prettyStyleWithIcon","prettyIcon","uglyStyle","uglyStyleWithIcon","uglyIcon","ignoredStyle","ignoredStyleWithIcon","ignoredIcon","prettiest","console","log","prettyArray","filter","uglyArray","ignoredArray","length","process","exit"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEA,MAAM;EAAEA,aAAF;EAAiBC,WAAjB;EAA8BC;IAAUC,OAAO,CAAC,UAAD,CAArD;;AAEA,MAAaC,WAAW,GAAG,OAAO;EAAEC,SAAF;EAAaC,UAAb;EAAyBC,WAAW,GAAG,MAAM;CAApD,KAA6D;QAChFC,MAAM,GAAG,EAAf;QAEMC,OAAO,CAACC,GAAR,CACJJ,UAAU,CAACK,GAAX,CAAe,MAAOC,SAAP,IAAqB;UAC5BC,IAAI,GAAI,GAAER,SAAU,IAAGO,SAAU,EAAvC;UACM,CAACE,MAAD,EAASC,OAAT,EAAkBC,IAAlB,IAA0B,MAAMP,OAAO,CAACC,GAAR,CAAY,CAChDO,sBAAsB,CAACJ,IAAD,CAD0B,EAEhDb,aAAa,CAACa,IAAD,CAFmC,EAGhDZ,WAAW,CAACY,IAAD,CAHqC,CAAZ,CAAtC;UAMM;MAAEK;QAAYF,IAApB;UACMG,MAAM,GAAGD,OAAO,GAAGE,SAAH,GAAelB,KAAK,CAACY,MAAD,oBAAcC,OAAd;MAAuBM,QAAQ,EAAER;OAA3E;IACAN,WAAW,CAAC;MAAEK,SAAF;MAAaO,MAAb;MAAqBD;KAAtB,CAAX;IACAV,MAAM,CAACI,SAAD,CAAN,GAAoB;MAAEO,MAAF;MAAUD;KAA9B;GAXF,CADI,CAAN;SAgBOV,MAAP;CAnBK;;AAsBP,MAAMS,sBAAsB,GAAIK,QAAD,IAC7B,IAAIb,OAAJ,CAAY,CAACc,OAAD,EAAUC,MAAV,KAAqB;EAC/BC,EAAE,CAACC,QAAH,CAAYJ,QAAZ,EAAsB,CAACK,KAAD,EAAQC,MAAR,KAAmB;QACnCD,KAAJ,EAAW;MACTH,MAAM,CAACG,KAAD,CAAN;KADF,MAEO;MACLJ,OAAO,CAACK,MAAM,CAACC,QAAP,EAAD,CAAP;;GAJJ;CADF,CADF;;AC1BA,MAAMC,KAAK,GAAG,SAAd;AACA,MAAMC,KAAK,GAAG,UAAd;AACA,MAAMC,GAAG,GAAG,UAAZ;AACA,MAAMC,IAAI,GAAG,UAAb;AAEA,AAAO,MAAMC,WAAW,GAAIC,MAAD,IAAa,GAAEJ,KAAM,GAAEI,MAAO,GAAEL,KAAM,EAA1D;AACP,AAAO,MAAMM,mBAAmB,GAAID,MAAD,IAAYD,WAAW,CAAE,GAAEG,UAAW,IAAGF,MAAO,EAAzB,CAAnD;AACP,MAAME,UAAU,GAAG,QAAnB;;AAEA,AAAO,MAAMC,SAAS,GAAIH,MAAD,IAAa,GAAEH,GAAI,GAAEG,MAAO,GAAEL,KAAM,EAAtD;AACP,AAAO,MAAMS,iBAAiB,GAAIJ,MAAD,IAAYG,SAAS,CAAE,GAAEE,QAAS,IAAGL,MAAO,EAAvB,CAA/C;AACP,MAAMK,QAAQ,GAAG,QAAjB;;AAEA,AAAO,MAAMC,YAAY,GAAIN,MAAD,IAAa,GAAEF,IAAK,GAAEE,MAAO,GAAEL,KAAM,EAA1D;AACP,AAAO,MAAMY,oBAAoB,GAAIP,MAAD,IAAYM,YAAY,CAAE,GAAEE,WAAY,IAAGR,MAAO,EAA1B,CAArD;AACP,MAAMQ,WAAW,GAAG,QAApB;;MCLaC,SAAS,GAAG,OAAO;EAAEvC,SAAF;EAAaC;CAApB,KAAqC;QACtDE,MAAM,GAAG,MAAMJ,WAAW,CAAC;IAC/BC,SAD+B;IAE/BC,UAF+B;IAG/BC,WAAW,EAAE,CAAC;MAAEK,SAAF;MAAaO,MAAb;MAAqBD;KAAtB,KAAoC;UAC3CA,OAAJ,EAAa;QACX2B,OAAO,CAACC,GAAR,CAAa,GAAElC,SAAU,OAAM8B,oBAAoB,CAAC,SAAD,CAAY,EAA/D;;;;UAGEvB,MAAJ,EAAY;QACV0B,OAAO,CAACC,GAAR,CAAa,GAAElC,SAAU,OAAMwB,mBAAmB,CAAC,QAAD,CAAW,EAA7D;;;;MAGFS,OAAO,CAACC,GAAR,CAAa,GAAElC,SAAU,OAAM2B,iBAAiB,CAAC,MAAD,CAAS,EAAzD;;GAZ4B,CAAhC;QAgBMQ,WAAW,GAAGzC,UAAU,CAAC0C,MAAX,CAAmBpC,SAAD,IAAe;WAC5C,CAACJ,MAAM,CAACI,SAAD,CAAN,CAAkBM,OAAnB,IAA8BV,MAAM,CAACI,SAAD,CAAN,CAAkBO,MAAvD;GADkB,CAApB;QAGM8B,SAAS,GAAG3C,UAAU,CAAC0C,MAAX,CAAmBpC,SAAD,IAAe;WAC1C,CAACJ,MAAM,CAACI,SAAD,CAAN,CAAkBM,OAAnB,IAA8B,CAACV,MAAM,CAACI,SAAD,CAAN,CAAkBO,MAAxD;GADgB,CAAlB;QAGM+B,YAAY,GAAG5C,UAAU,CAAC0C,MAAX,CAAmBpC,SAAD,IAAe;WAC7CJ,MAAM,CAACI,SAAD,CAAN,CAAkBM,OAAzB;GADmB,CAArB;EAIA2B,OAAO,CAACC,GAAR,CACG,GAAExC,UAAU,CAAC6C,MAAO;IACrBjB,WAAW,CAAE,GAAEa,WAAW,CAACI,MAAO,SAAvB,CAAiC;IAC5Cb,SAAS,CAAE,GAAEW,SAAS,CAACE,MAAO,OAArB,CAA6B;IACtCV,YAAY,CAAE,GAAES,YAAY,CAACC,MAAO,UAAxB,CAAmC,EAJjD;;MAOIF,SAAS,CAACE,MAAd,EAAsB;IACpBC,OAAO,CAACC,IAAR,CAAa,CAAb;GADF,MAEO;IACLD,OAAO,CAACC,IAAR,CAAa,CAAb;;CArCG;;;;;"}