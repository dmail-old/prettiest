{"version":3,"file":"index.js","sources":["../src/checkFormat.js","../src/style.js","../src/prettiest.js"],"sourcesContent":["import fs from \"fs\"\n\nconst { resolveConfig, getFileInfo, check } = require(\"prettier\")\n\nexport const checkFormat = async ({ folder, filenameRelativeArray, afterFormat = () => {} }) => {\n  const report = {}\n\n  await Promise.all(\n    filenameRelativeArray.map(async (filenameRelative) => {\n      const filename = `${folder}/${filenameRelative}`\n      const [source, options, info] = await Promise.all([\n        getFileContentAsString(filename),\n        resolveConfig(filename),\n        getFileInfo(filename),\n      ])\n\n      const { ignored } = info\n      const pretty = ignored ? undefined : check(source, { ...options, filepath: filename })\n      afterFormat({ filenameRelative, pretty, ignored })\n      report[filenameRelative] = { pretty, ignored }\n    }),\n  )\n\n  return report\n}\n\nconst getFileContentAsString = (pathname) =>\n  new Promise((resolve, reject) => {\n    fs.readFile(pathname, (error, buffer) => {\n      if (error) {\n        reject(error)\n      } else {\n        resolve(buffer.toString())\n      }\n    })\n  })\n","const close = \"\\x1b[0m\"\nconst green = \"\\x1b[32m\"\nconst red = \"\\x1b[31m\"\nconst blue = \"\\x1b[34m\"\n\nexport const prettyStyle = (string) => `${green}${string}${close}`\nexport const prettyStyleWithIcon = (string) => prettyStyle(`${prettyIcon} ${string}`)\nconst prettyIcon = \"\\u2714\" // checkmark ✔\n\nexport const uglyStyle = (string) => `${red}${string}${close}`\nexport const uglyStyleWithIcon = (string) => uglyStyle(`${uglyIcon} ${string}`)\nconst uglyIcon = \"\\u2613\" // cross ☓\n\nexport const ignoredStyle = (string) => `${blue}${string}${close}`\nexport const ignoredStyleWithIcon = (string) => ignoredStyle(`${ignoredIcon} ${string}`)\nconst ignoredIcon = \"\\u003F\" // question mark ?\n","import { checkFormat } from \"./checkFormat.js\"\nimport {\n  prettyStyle,\n  uglyStyle,\n  ignoredStyle,\n  prettyStyleWithIcon,\n  uglyStyleWithIcon,\n  ignoredStyleWithIcon,\n} from \"./style.js\"\n\nexport const prettiest = async ({ folder, filenameRelativeArray }) => {\n  console.log(`\n-------------- format check start -----------------\n`)\n\n  const report = await checkFormat({\n    folder,\n    filenameRelativeArray,\n    afterFormat: ({ filenameRelative, pretty, ignored }) => {\n      if (ignored) {\n        console.log(`${filenameRelative} -> ${ignoredStyleWithIcon(\"ignored\")}`)\n        return\n      }\n      if (pretty) {\n        console.log(`${filenameRelative} -> ${prettyStyleWithIcon(\"pretty\")}`)\n        return\n      }\n      console.log(`${filenameRelative} -> ${uglyStyleWithIcon(\"ugly\")}`)\n    },\n  })\n\n  const prettyArray = filenameRelativeArray.filter(\n    (filenameRelativeArray) =>\n      !report[filenameRelativeArray].ignored && report[filenameRelativeArray].pretty,\n  )\n  const uglyArray = filenameRelativeArray.filter(\n    (filenameRelativeArray) =>\n      !report[filenameRelativeArray].ignored && !report[filenameRelativeArray].pretty,\n  )\n  const ignoredArray = filenameRelativeArray.filter(\n    (filenameRelativeArray) => report[filenameRelativeArray].ignored,\n  )\n\n  console.log(`\n-------------- format check result ----------------\n${filenameRelativeArray.length} files format checked\n- ${prettyStyle(`${prettyArray.length} pretty`)}\n- ${uglyStyle(`${uglyArray.length} ugly`)}\n- ${ignoredStyle(`${ignoredArray.length} ignored`)}\n---------------------------------------------------`)\n\n  if (uglyArray.length) {\n    process.exit(1)\n  } else {\n    process.exit(0)\n  }\n}\n"],"names":["resolveConfig","getFileInfo","check","require","checkFormat","folder","filenameRelativeArray","afterFormat","report","Promise","all","map","filenameRelative","filename","source","options","info","getFileContentAsString","ignored","pretty","undefined","filepath","pathname","resolve","reject","fs","readFile","error","buffer","toString","close","green","red","blue","prettyStyle","string","prettyStyleWithIcon","prettyIcon","uglyStyle","uglyStyleWithIcon","uglyIcon","ignoredStyle","ignoredStyleWithIcon","ignoredIcon","prettiest","console","log","prettyArray","filter","uglyArray","ignoredArray","length","process","exit"],"mappings":"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"}