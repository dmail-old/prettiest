{"version":3,"file":"index.js","sources":["../src/getReport.js"],"sourcesContent":["import fs from \"fs\"\nimport { createRoot } from \"@dmail/project-structure\"\n\nconst prettier = require(\"prettier\")\n\nconst getFileContentAsString = (location) =>\n  new Promise((resolve, reject) => {\n    fs.readFile(location, (error, buffer) => {\n      if (error) {\n        reject(error)\n      } else {\n        resolve(buffer.toString())\n      }\n    })\n  })\n\nexport const getReport = ({ root }) => {\n  return createRoot({ root }).then(({ forEachFileMatching }) => {\n    return forEachFileMatching(\n      ({ prettify }) => prettify,\n      ({ absoluteName }) => {\n        return Promise.all([\n          getFileContentAsString(absoluteName),\n          prettier.resolveConfig(absoluteName),\n        ]).then(([source, options]) => {\n          const pretty = prettier.check(source, { ...options, filepath: absoluteName })\n          return {\n            file: absoluteName,\n            pretty,\n          }\n        })\n      },\n    )\n  })\n}\n"],"names":["prettier","require","getFileContentAsString","location","Promise","resolve","reject","fs","readFile","error","buffer","toString","getReport","root","createRoot","then","forEachFileMatching","prettify","absoluteName","all","resolveConfig","source","options","pretty","check","filepath","file"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAGA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAD,CAAxB;;AAEA,MAAMC,sBAAsB,GAAIC,QAAD,IAC7B,IAAIC,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;EAC/BC,EAAE,CAACC,QAAH,CAAYL,QAAZ,EAAsB,CAACM,KAAD,EAAQC,MAAR,KAAmB;QACnCD,KAAJ,EAAW;MACTH,MAAM,CAACG,KAAD,CAAN;KADF,MAEO;MACLJ,OAAO,CAACK,MAAM,CAACC,QAAP,EAAD,CAAP;;GAJJ;CADF,CADF;;AAWA,MAAaC,SAAS,GAAG,CAAC;EAAEC;CAAH,KAAc;SAC9BC,2BAAU,CAAC;IAAED;GAAH,CAAV,CAAqBE,IAArB,CAA0B,CAAC;IAAEC;GAAH,KAA6B;WACrDA,mBAAmB,CACxB,CAAC;MAAEC;KAAH,KAAkBA,QADM,EAExB,CAAC;MAAEC;KAAH,KAAsB;aACbd,OAAO,CAACe,GAAR,CAAY,CACjBjB,sBAAsB,CAACgB,YAAD,CADL,EAEjBlB,QAAQ,CAACoB,aAAT,CAAuBF,YAAvB,CAFiB,CAAZ,EAGJH,IAHI,CAGC,CAAC,CAACM,MAAD,EAASC,OAAT,CAAD,KAAuB;cACvBC,MAAM,GAAGvB,QAAQ,CAACwB,KAAT,CAAeH,MAAf,oBAA4BC,OAA5B;UAAqCG,QAAQ,EAAEP;WAA9D;eACO;UACLQ,IAAI,EAAER,YADD;UAELK;SAFF;OALK,CAAP;KAHsB,CAA1B;GADK,CAAP;CADK;;;;"}